{%extends 'main_template.html' %}
{% load static %}
{% block head %}
        <script src="{%static '/scripts/failsafe.js' %}"></script>
{% endblock %}
{%block content%}

{% if perms.Beer.failsafe_mode %}
<div class="container">
    <div class="alert alert-danger" id="error_msg" role="alert">
      A simple secondary alert—check it out!
    </div>
    <div class="card">
        <div class="card-body">
            <div class="container">
                    <p>Revenu : {{ total }} €</p>
                    <p>Prix d'achats des biéres vendues : {{ total_buy_price }} €</p>
            </div>
        </div>
        <div class="card-footer text-white bg-secondary">
        Bénéfices théorique total : {{ benef }} €
        </div>
    </div>

    <div class="card mt-2">
        <div class="card-header bg-dark text-white">
            <div class="row">
                <div>Prix tréso <b>ATTENTION - Mode non reversible</b>
                    <div class="btn btn-danger disabled" id="statut">{{failsafe}}</div>
                </div>
            </div>
        </div>
        <div class="card-body">
        <div class="container">
              <div class="progress" style="height: 20px;">
                <div class="progress-bar bg-danger" role="progressbar" style="width: 25%; background-color:#428bca;" id="progress_bar"aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">Mise à jour des prix</div>
                <span id="progress_tip" data-toggle="tooltip" data-placement="top"></span>
                <!-- TODO: $('#element').tooltip('update'), for update position of tooltip-->
              </div>
            {% include 'prix_treso.html' with beers=beers %}
        </div>
    </div>
    <div class="card-footer text-white bg-dark">
        <div class="btn btn-danger ml-3"  data-toggle="modal" data-target="#activate_fail_safeModal">Activer le failsafe!</div>
    </div>
</div>
</div>


<!-- Modal -->

<div class="modal fade" id="activate_fail_safeModal" tabindex="-1" role="dialog" aria-labelledby="activate_fail_safeModalLabel" aria-hidden="true">
<div class="modal-dialog" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="activate_fail_safeModalLabel">Entrez votre mot de passe</h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
        {% csrf_token %}
        <div class="form-group">
          <p>Mot de passe *</p>
          <input type="password" class="form-control" id="failsafe_password" placeholder="password" required>
        </div>
        <div class="modal-footer">
          <div  class="btn btn-danger" onclick="activate_fail_safe()">activer!</div>
        </div>
    </div>

  </div>
</div>
</div>

{% endif %}
{%endblock%}
